import{r as n,i as t,j as s,ci as C,cT as A,Z as v,aj as L,cU as O,a6 as G,a1 as B,am as U,an as W,cV as Y,b5 as Q,aG as V,S as K}from"./vendor-9x6k4T-r.js";import{A as H}from"./AdminButton-Dr56qn7X.js";import{I as Z,D as F,a as $}from"./InstanceDetail-B4p22K57.js";import{D as q}from"./DetailsBadge-jKGz3Eqm.js";import{D as z,N as J}from"./NotesPanel-BWqAJJ8r.js";import{O as X,E as ee,D as se}from"./ActionDropdown-DlGcqXhK.js";import{P as te}from"./PageDetail-DJvgu_vJ.js";import{A as ae}from"./AttachmentPanel-D7Gvj1Gg.js";import{P as oe}from"./PanelGroup-BCG3mCoU.js";import{c as w,A as l,U as i,e as I,m as g}from"./index-Bd_yPD7D.js";import{c as re}from"./CompanyForms-BzJpK2Vu.js";import{u as S,a as D,b as R,A as T}from"./UseForm-C7xHtQGh.js";import{u as ie}from"./UseInstance-Cb46b_w1.js";import{Y as ne}from"./YesNoButton-BsHbI51V.js";import{u as P,R as y,a as E,I as N}from"./InvenTreeTable-KDc6oHjF.js";import{L as le}from"./ColumnRenderers-CTwRHGdM.js";import{M as ce}from"./ManufacturerPartTable-Bk-jo5Pr.js";import{P as de}from"./PurchaseOrderTable-DBVrol5W.js";import{S as pe}from"./SupplierPartTable-CtAov5fF.js";import{S as me,R as ue}from"./SalesOrderTable-Cyvsz38G.js";import{S as M}from"./StockItemTable-C1bOB_vf.js";import{C as he,e as _e}from"./ThemeContext-DRe09WSE.js";import"./DesktopAppView-D7dqNL6j.js";import"./formatters-MBbtNL9a.js";import"./dayjs.min-DUmzidR_.js";import"./navigation-BUwul1Ze.js";import"./Instance-ZaRjKoLj.js";import"./ApiIcon-BBFuOj6_.js";import"./GenericErrorPage-C2ho8aty.js";import"./NotFound-o4Sp_RYV.js";import"./PermissionDenied-Di_W_uvf.js";import"./PageTitle-D--W0kLm.js";import"./AttachmentLink-r3l6VS50.js";import"./RemoteComponent-C0S0OuAi.js";import"./PurchaseOrderForms-CTnFU4km.js";import"./RemoveRowButton-PzDbXrvR.js";import"./UseGenerator-BZWzvoyo.js";import"./UseFilter-DqHeVZaa.js";import"./ReturnOrderForms-BbwWjf5K.js";import"./SalesOrderForms-DbF3BT5u.js";import"./OrderPartsWizard-BpRHlLRb.js";import"./UsePlaceholder-C_lBT7aw.js";function be({companyId:u,params:h}){const o=w(),r=P("address"),e=n.useMemo(()=>[{accessor:"title",sortable:!0,switchable:!1},{accessor:"primary",switchable:!1,sortable:!1,render:a=>ne({value:a.primary})},{accessor:"address",title:t._({id:"Du6bPw"}),sortable:!1,switchable:!1,render:a=>{let p="";return a!=null&&a.line1&&(p+=a.line1),a!=null&&a.line2&&(p+=` ${a.line2}`),p.trim()}},{accessor:"postal_code",sortable:!1,switchable:!0},{accessor:"postal_city",sortable:!1,switchable:!0},{accessor:"province",sortable:!1,switchable:!0},{accessor:"country",sortable:!1,switchable:!0},{accessor:"shipping_notes",sortable:!1,switchable:!0},{accessor:"internal_shipping_notes",sortable:!1,switchable:!0},le({})],[]),m=n.useMemo(()=>({company:{},title:{},primary:{},line1:{},line2:{},postal_code:{},postal_city:{},province:{},country:{},shipping_notes:{},internal_shipping_notes:{},link:{}}),[]),c=S({url:l.address_list,title:t._({id:"W0pjLr"}),fields:m,initialData:{company:u},successMessage:t._({id:"N0ZOat"}),table:r}),[_,b]=n.useState(-1),f=D({url:l.address_list,pk:_,title:t._({id:"xLQ0lF"}),fields:m,table:r}),d=R({url:l.address_list,pk:_,title:t._({id:"xiRN5x"}),preFormWarning:t._({id:"F1bgq9"}),table:r}),k=n.useCallback(a=>{const p=o.hasChangeRole(i.purchase_order)||o.hasChangeRole(i.sales_order),j=o.hasDeleteRole(i.purchase_order)||o.hasDeleteRole(i.sales_order);return[y({hidden:!p,onClick:()=>{b(a.pk),f.open()}}),E({hidden:!j,onClick:()=>{b(a.pk),d.open()}})]},[o]),x=n.useMemo(()=>{const a=o.hasChangeRole(i.purchase_order)||o.hasChangeRole(i.sales_order);return[s.jsx(T,{tooltip:t._({id:"W0pjLr"}),onClick:()=>c.open(),hidden:!a},"add-address")]},[o]);return s.jsxs(s.Fragment,{children:[c.modal,f.modal,d.modal,s.jsx(N,{url:I(l.address_list),tableState:r,columns:e,props:{enableDownload:!0,rowActions:k,tableActions:x,params:{...h,company:u}}})]})}function fe({companyId:u,params:h}){const o=w(),r=P("contact"),e=n.useMemo(()=>[{accessor:"name",sortable:!0,switchable:!1},{accessor:"phone",switchable:!0,sortable:!1},{accessor:"email",switchable:!0,sortable:!1},{accessor:"role",switchable:!0,sortable:!1}],[]),m=n.useMemo(()=>({company:{},name:{},phone:{},email:{},role:{}}),[]),[c,_]=n.useState(0),b=D({url:l.contact_list,pk:c,title:t._({id:"mQpWAe"}),fields:m,onFormSuccess:a=>r.updateRecord(a)}),f=S({url:l.contact_list,title:t._({id:"M0FgOk"}),initialData:{company:u},fields:m,table:r}),d=R({url:l.contact_list,pk:c,title:t._({id:"0oMKRL"}),table:r}),k=n.useCallback(a=>{const p=o.hasChangeRole(i.purchase_order)||o.hasChangeRole(i.sales_order),j=o.hasDeleteRole(i.purchase_order)||o.hasDeleteRole(i.sales_order);return[y({hidden:!p,onClick:()=>{_(a.pk),b.open()}}),E({hidden:!j,onClick:()=>{_(a.pk),d.open()}})]},[o]),x=n.useMemo(()=>{const a=o.hasAddRole(i.purchase_order)||o.hasAddRole(i.sales_order);return[s.jsx(T,{tooltip:t._({id:"QsNWTM"}),onClick:()=>f.open(),hidden:!a},"add-contact")]},[o]);return s.jsxs(s.Fragment,{children:[f.modal,b.modal,d.modal,s.jsx(N,{url:I(l.contact_list),tableState:r,columns:e,props:{enableDownload:!0,rowActions:k,tableActions:x,params:{...h,company:u}}})]})}function is(u){const{id:h}=he(),o=_e(),r=w(),{instance:e,refreshInstance:m,instanceQuery:c,requestStatus:_}=ie({endpoint:l.company_list,pk:h,params:{},refetchOnMount:!0}),b=n.useMemo(()=>{if(c.isFetching)return s.jsx(C,{});const p=[{type:"text",name:"description",label:t._({id:"Nu4oKW"}),copy:!0},{type:"link",name:"website",label:t._({id:"On0aF2"}),external:!0,copy:!0,hidden:!e.website},{type:"text",name:"phone",label:t._({id:"HF6C2L"}),copy:!0,hidden:!e.phone},{type:"text",name:"email",label:t._({id:"hzKQCy"}),copy:!0,hidden:!e.email}],j=[{type:"string",name:"currency",label:t._({id:"xjO9oI"})},{type:"boolean",name:"is_supplier",label:t._({id:"PYTEl0"}),icon:"suppliers"},{type:"boolean",name:"is_manufacturer",label:t._({id:"+m9/3S"}),icon:"manufacturers"},{type:"boolean",name:"is_customer",label:t._({id:"876pfE"}),icon:"customers"}];return s.jsxs(Z,{children:[s.jsxs(A,{children:[s.jsx(A.Col,{span:4,children:s.jsx(z,{appRole:i.purchase_order,apiPath:I(l.company_list,e.pk),src:e.image,pk:e.pk,refresh:m,imageActions:{uploadFile:!0,downloadImage:!0,deleteFile:!0}})}),s.jsx(A.Col,{span:8,children:s.jsx(F,{item:e,fields:p})})]}),s.jsx(F,{item:e,fields:j})]})},[e,c]),f=n.useMemo(()=>[{name:"details",label:t._({id:"eDkDvt"}),icon:s.jsx(v,{}),content:b},{name:"manufactured-parts",label:t._({id:"glJbgw"}),icon:s.jsx(L,{}),hidden:!(e!=null&&e.is_manufacturer),content:(e==null?void 0:e.pk)&&s.jsx(ce,{params:{manufacturer:e.pk}})},{name:"supplied-parts",label:t._({id:"i4b9ex"}),icon:s.jsx(O,{}),hidden:!(e!=null&&e.is_supplier),content:(e==null?void 0:e.pk)&&s.jsx(pe,{params:{supplier:e.pk}})},{name:"purchase-orders",label:t._({id:"85Yvr2"}),icon:s.jsx(G,{}),hidden:!(e!=null&&e.is_supplier),content:(e==null?void 0:e.pk)&&s.jsx(de,{supplierId:e.pk})},{name:"stock-items",label:t._({id:"Jbck4N"}),icon:s.jsx(B,{}),hidden:!(e!=null&&e.is_manufacturer)&&!(e!=null&&e.is_supplier),content:(e==null?void 0:e.pk)&&s.jsx(M,{allowAdd:!1,tableName:"company-stock",params:{company:e.pk}})},{name:"sales-orders",label:t._({id:"B1TL+X"}),icon:s.jsx(U,{}),hidden:!(e!=null&&e.is_customer),content:(e==null?void 0:e.pk)&&s.jsx(me,{customerId:e.pk})},{name:"return-orders",label:t._({id:"LlTg8M"}),icon:s.jsx(W,{}),hidden:!(e!=null&&e.is_customer),content:e.pk?s.jsx(ue,{customerId:e.pk}):s.jsx(C,{})},{name:"assigned-stock",label:t._({id:"TVGEcl"}),icon:s.jsx(Y,{}),hidden:!(e!=null&&e.is_customer),content:e!=null&&e.pk?s.jsx(M,{allowAdd:!1,tableName:"assigned-stock",showLocation:!1,params:{customer:e.pk}}):s.jsx(C,{})},{name:"contacts",label:t._({id:"gVfVfe"}),icon:s.jsx(Q,{}),content:(e==null?void 0:e.pk)&&s.jsx(fe,{companyId:e.pk})},{name:"addresses",label:t._({id:"bYmAV1"}),icon:s.jsx(V,{}),content:(e==null?void 0:e.pk)&&s.jsx(be,{companyId:e.pk})},ae({model_type:g.company,model_id:e.pk}),J({model_type:g.company,model_id:e.pk})],[h,e,r]),d=D({url:l.company_list,pk:e==null?void 0:e.pk,title:t._({id:"HoG6cl"}),fields:re(),onFormSuccess:m}),k=R({url:l.company_list,pk:e==null?void 0:e.pk,title:t._({id:"riHm27"}),onFormSuccess:()=>{o("/")}}),x=n.useMemo(()=>[s.jsx(H,{model:g.company,id:e.pk}),s.jsx(X,{tooltip:t._({id:"z+ZEYC"}),actions:[ee({hidden:!r.hasChangeRole(i.purchase_order),onClick:()=>d.open()}),se({hidden:!r.hasDeleteRole(i.purchase_order),onClick:()=>k.open()})]})],[h,e,r]),a=n.useMemo(()=>[s.jsx(q,{label:t._({id:"NoNwIX"}),color:"red",visible:e.active==!1})],[e]);return s.jsxs(s.Fragment,{children:[d.modal,k.modal,s.jsx($,{status:_,loading:c.isFetching,children:s.jsxs(K,{gap:"xs",children:[s.jsx(te,{title:`${t._({id:"7i8j3G"})}: ${e.name}`,subtitle:e.description,actions:x,imageUrl:e.image,breadcrumbs:u.breadcrumbs,badges:a,editAction:d.open,editEnabled:r.hasChangePermission(g.company)}),s.jsx(oe,{pageKey:"company",panels:f,instance:e,model:g.company,id:e.pk})]})})]})}export{is as default};
