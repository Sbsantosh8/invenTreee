import{r as d,i as e,j as a,dA as ee,aP as te,dB as ie,a0 as se,b1 as ae,b5 as ne,bA as le,ce as Q,bD as E,S as oe,cq as w,m as p,G as H,dC as re,ci as de}from"./vendor-9x6k4T-r.js";import{u as W,b as ce,S as ue,c as B,T as Y,A as _e}from"./UseForm-C7xHtQGh.js";import{A as pe}from"./ActionDropdown-DlGcqXhK.js";import{O as fe}from"./OrderPartsWizard-BpRHlLRb.js";import{b as me,c as he}from"./formatters-MBbtNL9a.js";import{l as G,m as P,e as V,A as k,a as K,c as be,U as A}from"./index-Bd_yPD7D.js";import{d as ge}from"./dayjs.min-DUmzidR_.js";import{R as xe}from"./RemoveRowButton-PzDbXrvR.js";import{T as Z,S as ke}from"./Instance-ZaRjKoLj.js";import{I as x,F as je,S as Se}from"./ThemeContext-DRe09WSE.js";import{u as ye,a as ve}from"./UseGenerator-BZWzvoyo.js";import{u as Ce}from"./UsePlaceholder-C_lBT7aw.js";import{S as $,u as Te,I as Fe}from"./InvenTreeTable-KDc6oHjF.js";import{a as Pe,D as Re,g as ze,S as Ae,i as Ee,j as I}from"./ColumnRenderers-CTwRHGdM.js";function Me({partId:t,stockItem:l,create:i=!1}){const s=G(),[n,c]=d.useState({}),[o,u]=d.useState(null),[r,m]=d.useState(""),[h,_]=d.useState(""),[v,b]=d.useState(null),g=ye(j=>{m(j?`${e._({id:"iAY2dt"})}: ${j}`:"")}),S=ve(j=>{_(j?`${e._({id:"TVYdHj"})}: ${j}`:"")});return d.useEffect(()=>{n!=null&&n.pk&&(g.update({part:n.pk}),S.update({part:n.pk}))},[n.pk]),d.useMemo(()=>{const j={part:{value:n.pk,disabled:!i,filters:{active:i?!0:void 0},onValueChange:(f,C)=>{c(C),u(null);const T=(C==null?void 0:C.default_expiry)??0;T&&T>0&&b(ge().add(T,"days").toISOString())}},supplier_part:{hidden:(n==null?void 0:n.purchaseable)==!1,value:o,onValueChange:f=>{u(f)},filters:{part_detail:!0,supplier_detail:!0,part:t},adjustFilters:f=>(f.data.part&&(f.filters.part=f.data.part),f.filters)},use_pack_size:{hidden:!i,description:e._({id:"qyS7x9"})},location:{hidden:!i,onValueChange:f=>{g.update({location:f})},filters:{structural:!1}},quantity:{hidden:!i,description:e._({id:"LWFE8j"}),onValueChange:f=>{g.update({quantity:f})}},serial_numbers:{field_type:"string",label:e._({id:"VzQT2x"}),disabled:(n==null?void 0:n.trackable)==!1,description:e._({id:"0dR85g"}),required:!1,hidden:!i,placeholder:h},serial:{hidden:i||n.trackable==!1||(l==null?void 0:l.quantity)!=null&&(l==null?void 0:l.quantity)!=1},batch:{placeholder:r},status_custom_key:{label:e._({id:"Y3/0dR"})},expiry_date:{icon:a.jsx(ee,{}),hidden:!s.isSet("STOCK_ENABLE_EXPIRY"),value:v,onValueChange:f=>{b(f)}},purchase_price:{icon:a.jsx(te,{})},purchase_price_currency:{icon:a.jsx(ie,{})},packaging:{icon:a.jsx(se,{})},link:{icon:a.jsx(ae,{})},owner:{icon:a.jsx(ne,{})},delete_on_deplete:{}};return s.isSet("STOCK_ENABLE_EXPIRY")||delete j.expiry_date,j},[l,v,n,t,s,o,h,r,i])}function ft(){return d.useMemo(()=>({location:{filters:{structural:!1}},note:{}}),[])}function mt({stockItem:t}){const l=G(),[i,s]=d.useState(null);return d.useEffect(()=>{s(null)},[t]),d.useMemo(()=>({part:{field_type:"related field",required:!0,exclude:!0,label:e._({id:"vgP+9p"}),description:e._({id:"B+pzHp"}),model:P.part,api_url:V(k.part_list),onValueChange:n=>{s(n)},filters:{trackable:!0,in_bom_for:l.isSet("STOCK_ENFORCE_BOM_INSTALLATION")?t.part:void 0}},stock_item:{disabled:!i,filters:{part_detail:!0,in_stock:!0,available:!0,tracked:!0,part:i||void 0}},quantity:{},note:{}}),[l,i,t])}function ht({partId:t,trackable:l}){const i=Ce({partId:t,key:"stock-item-serialize",enabled:l});return d.useMemo(()=>({quantity:{},serial_numbers:{placeholder:i},destination:{}}),[i])}function qe({stockItem:t,value:l}){var s,n;const{data:i}=re({queryKey:["location",((s=t.part_detail)==null?void 0:s.default_location)??((n=t.part_detail)==null?void 0:n.category_default_location)],queryFn:async()=>{var o,u;const c=V(k.stock_location_list,((o=t.part_detail)==null?void 0:o.default_location)??((u=t.part_detail)==null?void 0:u.category_default_location));return K.get(c).then(r=>{switch(r.status){case 200:return r.data;default:return null}}).catch(()=>null)}});return a.jsxs(w,{gap:"sm",justify:"space-evenly",align:"center",children:[a.jsxs(w,{gap:"sm",direction:"column",align:"center",children:[a.jsxs(p,{children:[l," x ",t.part_detail.name]}),a.jsx(Z,{src:t.part_detail.thumbnail,size:80,align:"center"})]}),a.jsxs(w,{direction:"column",gap:"sm",align:"center",children:[a.jsx(p,{children:t.location_detail.pathstring}),a.jsx(x,{icon:"arrow_down"}),a.jsx(d.Suspense,{fallback:a.jsx(de,{width:"150px"}),children:a.jsx(p,{children:i==null?void 0:i.pathstring})})]})]})}function De(t,l,i){je.openConfirmModal({title:a.jsx(Se,{children:e._({id:"AEaskR"})}),children:a.jsx(qe,{stockItem:t,value:l}),onConfirm:()=>{var s,n,c,o;t.location===((s=t.part_detail)==null?void 0:s.default_location)||t.location===((n=t.part_detail)==null?void 0:n.category_default_location)||K.post(V(k.stock_transfer),{items:[{pk:t.pk,quantity:l,batch:t.batch,status:t.status}],location:((c=t.part_detail)==null?void 0:c.default_location)??((o=t.part_detail)==null?void 0:o.category_default_location)}).then(u=>(i(),u.data)).catch(()=>null)}})}function R({props:t,transfer:l=!1,changeStatus:i=!1,add:s=!1,setMax:n=!1,merge:c=!1,record:o}){var C,T,M,q,D,L,O,J,N,F;const u=d.useMemo(()=>{var y;return((y=$(P.stockitem)())==null?void 0:y.map(U=>({value:U.value,display_name:U.label})))??[]},[]),[r,m]=d.useState(s?0:((C=t.item)==null?void 0:C.quantity)??0),[h,_]=d.useState(void 0),v=()=>{t.removeFn(t.idx)},[b,g]=Q(!1,{onOpen:()=>{l&&t.changeFn(t.idx,"packaging",(o==null?void 0:o.packaging)||void 0)},onClose:()=>{l&&t.changeFn(t.idx,"packaging",void 0)}}),[S,j]=Q(!1,{onOpen:()=>{_((o==null?void 0:o.status_custom_key)||(o==null?void 0:o.status)||void 0),t.changeFn(t.idx,"status",(o==null?void 0:o.status)||void 0)},onClose:()=>{_(void 0),t.changeFn(t.idx,"status",void 0)}}),f=d.useMemo(()=>o?o.serial?`#${o.serial}`:`${o.quantity}`:"-",[o]);return o?a.jsxs(a.Fragment,{children:[a.jsxs(E.Tr,{children:[a.jsx(E.Td,{children:a.jsxs(oe,{gap:"xs",children:[a.jsxs(w,{gap:"sm",align:"center",children:[a.jsx(Z,{size:40,src:(T=o.part_detail)==null?void 0:T.thumbnail,align:"center"}),a.jsx("div",{children:(M=o.part_detail)==null?void 0:M.name})]}),((D=(q=t.rowErrors)==null?void 0:q.pk)==null?void 0:D.message)&&a.jsx(p,{c:"red",size:"xs",children:t.rowErrors.pk.message})]})}),a.jsx(E.Td,{children:o.location?(L=o.location_detail)==null?void 0:L.pathstring:"-"}),a.jsx(E.Td,{children:a.jsxs(H,{grow:!0,justify:"space-between",wrap:"nowrap",children:[a.jsx(p,{children:f}),a.jsx(ke,{status:o.status_custom_key,type:P.stockitem})]})}),!c&&a.jsx(E.Td,{children:a.jsx(ue,{fieldName:"quantity",fieldDefinition:{field_type:"number",value:r,onValueChange:y=>{m(y),t.changeFn(t.idx,"quantity",y)}},error:(J=(O=t.rowErrors)==null?void 0:O.quantity)==null?void 0:J.message})}),a.jsx(E.Td,{children:a.jsxs(w,{gap:"3px",children:[l&&a.jsx(B,{onClick:()=>De(o,t.item.quantity,v),icon:a.jsx(x,{icon:"default_location"}),tooltip:e._({id:"b+SPUR"}),tooltipAlignment:"top",disabled:!((N=o.part_detail)!=null&&N.default_location)&&!((F=o.part_detail)!=null&&F.category_default_location)}),i&&a.jsx(B,{size:"sm",icon:a.jsx(x,{icon:"status"}),tooltip:e._({id:"Gt4cm5"}),onClick:()=>j.toggle(),variant:S?"filled":"transparent"}),l&&a.jsx(B,{size:"sm",icon:a.jsx(x,{icon:"packaging"}),tooltip:e._({id:"O7MZ1G"}),onClick:()=>g.toggle(),variant:b?"filled":"transparent"}),a.jsx(xe,{onClick:()=>t.removeFn(t.idx)})]})})]}),i&&a.jsx(Y,{visible:S,onValueChange:y=>{_(y),t.changeFn(t.idx,"status",y||void 0)},fieldName:"status",fieldDefinition:{field_type:"choice",label:e._({id:"uAQUqI"}),choices:u,value:h},defaultValue:h}),l&&a.jsx(Y,{visible:l&&b,onValueChange:y=>{t.changeFn(t.idx,"packaging",y||void 0)},fieldName:"packaging",fieldDefinition:{field_type:"string",label:e._({id:"pD/Ew0"})},defaultValue:o.packaging})]}):a.jsx("div",{children:e._({id:"Z3FXyt"})})}function X(t){return t.map(i=>({pk:i.pk,quantity:i.quantity,batch:i.batch||void 0,status:i.status||void 0,packaging:i.packaging||void 0,obj:i}))}function Le(t){if(!t)return{};const l=Object.fromEntries(t.map(s=>[s.pk,s]));return{items:{field_type:"table",value:X(t),modelRenderer:s=>{const n=l[s.item.pk];return a.jsx(R,{props:s,transfer:!0,changeStatus:!0,setMax:!0,record:n},n.pk)},headers:[e._({id:"vgP+9p"}),e._({id:"wJijgU"}),e._({id:"blbbPS"}),e._({id:"QWdKwH"}),e._({id:"7L01XJ"})]},location:{filters:{structural:!1}},notes:{}}}function Oe(t){if(!t)return{};const l=Object.fromEntries(t.map(s=>[s.pk,s]));return{items:{field_type:"table",value:X(t),modelRenderer:s=>{const n=l[s.item.pk];return a.jsx(R,{props:s,setMax:!0,changeStatus:!0,add:!0,record:n},n.pk)},headers:[e._({id:"vgP+9p"}),e._({id:"wJijgU"}),e._({id:"zn38D/"}),e._({id:"t/YqKh"}),e._({id:"7L01XJ"})]},notes:{}}}function we(t){if(!t)return{};const l=Object.fromEntries(t.map(s=>[s.pk,s]));return{items:{field_type:"table",value:X(t),modelRenderer:s=>{const n=l[s.item.pk];return a.jsx(R,{changeStatus:!0,props:s,add:!0,record:n},n.pk)},headers:[e._({id:"vgP+9p"}),e._({id:"wJijgU"}),e._({id:"zn38D/"}),e._({id:"m16xKo"}),e._({id:"7L01XJ"})]},notes:{}}}function Ge(t){if(!t)return{};const l=Object.fromEntries(t.map(s=>[s.pk,s]));return{items:{field_type:"table",value:X(t),modelRenderer:s=>a.jsx(R,{props:s,changeStatus:!0,record:l[s.item.pk]},s.item.pk),headers:[e._({id:"vgP+9p"}),e._({id:"wJijgU"}),e._({id:"zn38D/"}),e._({id:"wBMjJ2"}),e._({id:"7L01XJ"})]},notes:{}}}function Ve(t){if(!t)return{};const l=Object.fromEntries(t.map(s=>[s.pk,s]));return{items:{field_type:"table",value:t.map(s=>s.pk),modelRenderer:s=>a.jsx(R,{props:s,merge:!0,record:l[s.item]},s.item),headers:[e._({id:"vgP+9p"}),e._({id:"wJijgU"}),e._({id:"zn38D/"}),e._({id:"7L01XJ"})]},status:{},note:{}}}function Je(t){var s;if(!t)return{};const l=Object.fromEntries(t.map(n=>[n.pk,n]));return{items:{field_type:"table",value:t.map(n=>({item:n.pk,obj:n})),modelRenderer:n=>a.jsx(R,{props:n,merge:!0,changeStatus:!0,record:l[n.item.item]},n.item.item),headers:[e._({id:"vgP+9p"}),e._({id:"wJijgU"}),e._({id:"zn38D/"}),e._({id:"7L01XJ"})]},location:{default:(s=t[0])==null?void 0:s.part_detail.default_location,filters:{structural:!1}},notes:{},allow_mismatched_suppliers:{},allow_mismatched_status:{}}}function Ne(t){if(!t)return{};const l=Object.fromEntries(t.map(s=>[s.pk,s]));return{items:{field_type:"table",value:t.map(s=>({item:s.pk,obj:s})),modelRenderer:s=>a.jsx(R,{props:s,merge:!0,record:l[s.item.item]},s.item.item),headers:[e._({id:"vgP+9p"}),e._({id:"wJijgU"}),e._({id:"zn38D/"}),e._({id:"7L01XJ"})]},customer:{filters:{is_customer:!0}},notes:{}}}function Ue(t){if(!t)return{};const l=Object.fromEntries(t.map(s=>[s.pk,s]));return{items:{field_type:"table",value:t.map(s=>s.pk),modelRenderer:s=>{const n=l[s.item];return a.jsx(R,{props:s,merge:!0,record:n},n.pk)},headers:[e._({id:"vgP+9p"}),e._({id:"wJijgU"}),e._({id:"zn38D/"}),e._({id:"7L01XJ"})]}}}function z({items:t,pk:l,model:i,refresh:s,fieldGenerator:n,endpoint:c,filters:o,title:u,successMessage:r,modalFunc:m=W}){const h={part_detail:!0,location_detail:!0,cascade:!1},_=d.useMemo(()=>{const g={...h,...o??{}};return g[i]=l===void 0&&i==="location"?"null":l,g},[h,o,i,l]),{data:v}=le({queryKey:["stockitems",i,l,t,_],queryFn:async()=>{if(t)return Array.isArray(t)?t:[t];const g=V(k.stock_item_list);return K.get(g,{params:_}).then(S=>{if(S.status===200)return S.data}).catch(()=>null)}}),b=d.useMemo(()=>n(v),[v]);return m({url:c,fields:b,title:u,size:"80%",successMessage:r,onFormSuccess:()=>s()})}function Xe(t){return z({...t,fieldGenerator:we,endpoint:k.stock_add,title:e._({id:"smUxso"}),successMessage:e._({id:"2kGS2K"})})}function Be(t){return z({...t,fieldGenerator:Oe,endpoint:k.stock_remove,title:e._({id:"dxvf6V"}),successMessage:e._({id:"uMaw0F"})})}function Ie(t){return z({...t,fieldGenerator:Le,endpoint:k.stock_transfer,title:e._({id:"9efe+k"}),successMessage:e._({id:"02r6MH"})})}function Ke(t){return z({...t,fieldGenerator:Ge,endpoint:k.stock_count,title:e._({id:"n/p2QJ"}),successMessage:e._({id:"iEFfQA"})})}function Qe(t){return z({...t,fieldGenerator:Ve,endpoint:k.stock_change_status,title:e._({id:"Y+vtBl"}),successMessage:e._({id:"dbA8fL"})})}function Ye(t){return z({...t,fieldGenerator:Je,endpoint:k.stock_merge,title:e._({id:"z5kN6j"}),successMessage:e._({id:"BSKV/s"})})}function He(t){const l=d.useMemo(()=>{var i;return(i=t.items)==null?void 0:i.filter(s=>{var n;return(n=s==null?void 0:s.part_detail)==null?void 0:n.salable})},[t.items]);return z({...t,items:l,fieldGenerator:Ne,endpoint:k.stock_assign,title:e._({id:"i2FExn"}),successMessage:e._({id:"zTh3Rb"})})}function We(t){return z({...t,fieldGenerator:Ue,endpoint:k.stock_item_list,modalFunc:ce,title:e._({id:"khKVoc"}),successMessage:e._({id:"9Y/rsA"})})}function bt(){return{parent:{description:e._({id:"9P2CtI"}),required:!1},name:{},description:{},structural:{},external:{},custom_icon:{field_type:"icon"},location_type:{}}}function gt({partId:t,itemId:l,templateId:i,editing:s=!1,editTemplate:n=!1}){const[c,o]=d.useState([]),[u,r]=d.useState("string"),m=G(),h=d.useMemo(()=>m.isSet("TEST_STATION_DATA"),[m]);return d.useMemo(()=>{const _={stock_item:{value:l,hidden:!0},template:{disabled:!n&&!!i,filters:{include_inherited:!0,part:t},onValueChange:(v,b)=>{if(b!=null&&b.choices){const g=b.choices.split(",");g.length>0?(o(g.map(S=>({label:S.trim(),value:S.trim()}))),r("choice")):(o([]),r("string"))}}},result:{},value:{field_type:u,choices:u==="choice"?c:void 0},attachment:{},notes:{},started_datetime:{hidden:!h},finished_datetime:{hidden:!h},test_station:{hidden:!h}};return s&&delete _.attachment,_},[c,s,n,u,t,l,i,h])}function Ze({showLocation:t,showPricing:l}){return[{accessor:"part",sortable:!0,render:i=>Pe({part:i==null?void 0:i.part_detail})},{accessor:"part_detail.IPN",title:e._({id:"3wXEsN"}),sortable:!0},{accessor:"part_detail.revision",title:e._({id:"6LTyxl"}),sortable:!0},Re({accessor:"part_detail.description"}),{accessor:"quantity",ordering:"stock",sortable:!0,title:e._({id:"blbbPS"}),render:i=>{const s=(i==null?void 0:i.quantity)??0,n=(i==null?void 0:i.allocated)??0,c=s-n;let o=s;const u=(i==null?void 0:i.part_detail)??{},r=[];let m;return i.serial&&s==1&&(o=`# ${i.serial}`),i.is_building?(m="blue",r.push(a.jsx(p,{size:"sm",children:e._({id:"fh2Vf5"})},"production"))):i.sales_order?r.push(a.jsx(p,{size:"sm",children:e._({id:"X1BIR/"})},"sales-order")):i.customer?r.push(a.jsx(p,{size:"sm",children:e._({id:"fHlvYo"})},"customer")):i.belongs_to?r.push(a.jsx(p,{size:"sm",children:e._({id:"bGwMIh"})},"belongs-to")):i.consumed_by?r.push(a.jsx(p,{size:"sm",children:e._({id:"Xig/cj"})},"consumed-by")):i.in_stock||r.push(a.jsx(p,{size:"sm",children:e._({id:"szsXHP"})},"unavailable")),i.expired?r.push(a.jsx(p,{size:"sm",children:e._({id:"x/QIhZ"})},"expired")):i.stale&&r.push(a.jsx(p,{size:"sm",children:e._({id:"UtuqjX"})},"stale")),i.in_stock&&(n>0&&(n>=s?(m="orange",r.push(a.jsx(p,{size:"sm",children:e._({id:"L1D5PL"})},"fully-allocated"))):r.push(a.jsx(p,{size:"sm",children:e._({id:"PjVOCj"})},"partially-allocated"))),c!=s&&(c>0?r.push(a.jsx(p,{size:"sm",c:"orange",children:`${e._({id:"csDS2L"})}: ${c}`},"available")):r.push(a.jsx(p,{size:"sm",c:"red",children:e._({id:"a5n/wL"})},"no-stock"))),s<=0&&r.push(a.jsx(p,{size:"sm",children:e._({id:"ddPzUj"})},"depleted"))),i.in_stock||(m="red"),a.jsx(ze,{value:a.jsxs(H,{gap:"xs",justify:"left",wrap:"nowrap",children:[a.jsx(p,{c:m,children:o}),u.units&&a.jsxs(p,{size:"xs",c:m,children:["[",u.units,"]"]})]}),title:e._({id:"odasNw"}),extra:r})}},Ae({model:P.stockitem}),{accessor:"batch",sortable:!0},Ee({hidden:!t,accessor:"location_detail"}),{accessor:"purchase_order",title:e._({id:"KxySMG"}),render:i=>i.purchase_order_reference},{accessor:"SKU",title:e._({id:"nne72x"}),sortable:!0},{accessor:"MPN",title:e._({id:"bisS0I"}),sortable:!0},{accessor:"purchase_price",title:e._({id:"vWelsN"}),sortable:!0,switchable:!0,hidden:!l,render:i=>me(i.purchase_price,{currency:i.purchase_price_currency})},{accessor:"stock_value",title:e._({id:"g9RfVq"}),sortable:!1,hidden:!l,render:i=>{var o,u;const s=i.purchase_price||((o=i.part_detail)==null?void 0:o.pricing_min),n=i.purchase_price||((u=i.part_detail)==null?void 0:u.pricing_max),c=i.purchase_price_currency||void 0;return he(s,n,{currency:c,multiplier:i.quantity})}},{accessor:"packaging",sortable:!0},I({title:e._({id:"uaSvqt"}),accessor:"expiry_date",hidden:!G.getState().isSet("STOCK_ENABLE_EXPIRY")}),I({title:e._({id:"K7P0jz"}),accessor:"updated"}),I({accessor:"stocktake_date",title:e._({id:"6OScNP"}),sortable:!0})]}function $e({enableExpiry:t}){return[{name:"active",label:e._({id:"F6pfE9"}),description:e._({id:"UjHL/d"})},{name:"status",label:e._({id:"uAQUqI"}),description:e._({id:"+Jr1e4"}),choiceFunction:$(P.stockitem)},{name:"assembly",label:e._({id:"WL36Yh"}),description:e._({id:"3Ah+L7"})},{name:"allocated",label:e._({id:"A/ybx7"}),description:e._({id:"pxiNcZ"})},{name:"available",label:e._({id:"csDS2L"}),description:e._({id:"kbUAFH"})},{name:"cascade",label:e._({id:"VY386J"}),description:e._({id:"fMbOmV"})},{name:"depleted",label:e._({id:"9/P0N3"}),description:e._({id:"0n9TfP"})},{name:"in_stock",label:e._({id:"zn38D/"}),description:e._({id:"oXdFGe"})},{name:"is_building",label:e._({id:"BE5Q6v"}),description:e._({id:"c64azd"})},{name:"include_variants",label:e._({id:"/g9i/Z"}),description:e._({id:"n9gDGi"})},{name:"consumed",label:e._({id:"XNITBt"}),description:e._({id:"1yWWZV"})},{name:"installed",label:e._({id:"eQkgKV"}),description:e._({id:"GQ73kf"})},{name:"sent_to_customer",label:e._({id:"XwjZor"}),description:e._({id:"LPuYfz"})},{name:"serialized",label:e._({id:"SkCY/+"}),description:e._({id:"S5yS1f"})},{name:"batch",label:e._({id:"Vea6Aj"}),description:e._({id:"Y/SfF6"}),type:"text"},{name:"serial",label:e._({id:"AXeJt4"}),description:e._({id:"hFRTeN"}),type:"text"},{name:"serial_lte",label:e._({id:"HnbC6h"}),description:e._({id:"yLzTzA"}),type:"text"},{name:"serial_gte",label:e._({id:"CSpSNh"}),description:e._({id:"Gnj5CL"}),type:"text"},{name:"has_batch",label:e._({id:"qPCbMt"}),description:e._({id:"rc/Y1E"})},{name:"tracked",label:e._({id:"EaG6cP"}),description:e._({id:"TRFyJq"})},{name:"has_purchase_price",label:e._({id:"+MprDT"}),description:e._({id:"tAFrkr"})},{name:"expired",label:e._({id:"M1RnFv"}),description:e._({id:"JiHUig"}),active:t},{name:"stale",label:e._({id:"1ba70W"}),description:e._({id:"SQjqoc"}),active:t},{name:"expiry_before",label:e._({id:"mHDi5V"}),description:e._({id:"j2+SIa"}),type:"date",active:t},{name:"expiry_after",label:e._({id:"snknx0"}),description:e._({id:"UyBcoZ"}),type:"date",active:t},{name:"updated_before",label:e._({id:"h8xl5M"}),description:e._({id:"5zwJta"}),type:"date"},{name:"updated_after",label:e._({id:"nl9mSR"}),description:e._({id:"P5Y0sz"}),type:"date"},{name:"stocktake_before",label:e._({id:"Hj/Grl"}),description:e._({id:"iTehcJ"}),type:"date"},{name:"stocktake_after",label:e._({id:"+GUu77"}),description:e._({id:"w30K80"}),type:"date"},{name:"external",label:e._({id:"k7rbV9"}),description:e._({id:"ETtRZU"})}]}function xt({params:t={},allowAdd:l=!1,showLocation:i=!0,showPricing:s=!0,tableName:n="stockitems"}){const c=Te(n),o=be(),u=G(),r=d.useMemo(()=>u.isSet("STOCK_ENABLE_EXPIRY"),[u]),m=d.useMemo(()=>Ze({showLocation:i??!0,showPricing:s??!0}),[i,s]),h=d.useMemo(()=>$e({enableExpiry:r}),[r]),_=d.useMemo(()=>({items:c.selectedRecords,model:P.stockitem,refresh:c.refreshTable,filters:{in_stock:!0}}),[c]),v=Me({create:!0,partId:t.part}),b=W({url:k.stock_item_list,title:e._({id:"bJLEQT"}),fields:v,initialData:{part:t.part,location:t.location},follow:!0,modelType:P.stockitem}),[g,S]=d.useState([]),j=fe({parts:g}),f=Ie(_),C=Xe(_),T=Be(_),M=Ke(_),q=Qe(_),D=Ye(_),L=He(_),O=We(_),J=d.useMemo(()=>{const N=o.hasDeleteRole(A.stock),F=o.hasAddRole(A.stock),y=o.hasAddRole(A.stocktake);return o.hasAddRole(A.purchase_order),o.hasChangeRole(A.purchase_order),[a.jsx(pe,{tooltip:e._({id:"bbA1t1"}),icon:a.jsx(x,{icon:"stock"}),disabled:c.selectedRecords.length===0,actions:[{name:e._({id:"n/p2QJ"}),icon:a.jsx(x,{icon:"stocktake",iconProps:{color:"blue"}}),tooltip:e._({id:"n/p2QJ"}),disabled:!y,onClick:()=>{M.open()}},{name:e._({id:"smUxso"}),icon:a.jsx(x,{icon:"add",iconProps:{color:"green"}}),tooltip:e._({id:"wiTIgC"}),disabled:!F,onClick:()=>{C.open()}},{name:e._({id:"dxvf6V"}),icon:a.jsx(x,{icon:"remove",iconProps:{color:"red"}}),tooltip:e._({id:"vP4ilC"}),disabled:!F,onClick:()=>{T.open()}},{name:e._({id:"9efe+k"}),icon:a.jsx(x,{icon:"transfer",iconProps:{color:"blue"}}),tooltip:e._({id:"lgwXs+"}),disabled:!F,onClick:()=>{f.open()}},{name:e._({id:"E6cz5z"}),icon:a.jsx(x,{icon:"info",iconProps:{color:"blue"}}),tooltip:e._({id:"/gndGd"}),disabled:!F,onClick:()=>{q.open()}},{name:e._({id:"3iu3Xl"}),icon:a.jsx(x,{icon:"merge"}),tooltip:e._({id:"V22osk"}),disabled:!F,onClick:()=>{D.open()}},{name:e._({id:"G4SnGh"}),icon:a.jsx(x,{icon:"buy"}),tooltip:e._({id:"iihIqf"}),hidden:!o.hasAddRole(A.purchase_order),disabled:!c.hasSelectedRecords,onClick:()=>{S(c.selectedRecords.map(U=>U.part_detail)),j.openWizard()}},{name:e._({id:"chR2IB"}),icon:a.jsx(x,{icon:"customer"}),tooltip:e._({id:"jETzQV"}),disabled:!F,onClick:()=>{L.open()}},{name:e._({id:"6vqSiF"}),icon:a.jsx(x,{icon:"delete",iconProps:{color:"red"}}),tooltip:e._({id:"khKVoc"}),disabled:!N,onClick:()=>{O.open()}}]},"stock-actions"),a.jsx(_e,{hidden:!l||!o.hasAddRole(A.stock),tooltip:e._({id:"bJLEQT"}),onClick:()=>b.open()},"add-stock-item")]},[o,l,c.hasSelectedRecords,c.selectedRecords]);return a.jsxs(a.Fragment,{children:[b.modal,f.modal,T.modal,C.modal,M.modal,q.modal,D.modal,L.modal,O.modal,j.wizard,a.jsx(Fe,{url:V(k.stock_item_list),tableState:c,columns:m,props:{enableDownload:!0,enableSelection:!0,enableLabels:!0,enableReports:!0,tableFilters:h,tableActions:J,modelType:P.stockitem,params:{...t,part_detail:!0,location_detail:!0,supplier_part_detail:!0}}})]})}export{xt as S,Ie as a,mt as b,ft as c,gt as d,Me as e,Xe as f,Be as g,He as h,ht as i,bt as s,Ke as u};
