import{j as a,J as T,S as L,bD as f,r as x,m as u,G as h,bA as A,ci as B,A as k,i as o,bC as z,cW as D,co as E,bF as P}from"./vendor-9x6k4T-r.js";import{r as C}from"./InvenTreeTable-KDc6oHjF.js";import{u as F}from"./DesktopAppView-D7dqNL6j.js";import{f as G}from"./formatters-MBbtNL9a.js";import{o as N,e as V,f as U,A as _,l as M,c as Y}from"./index-Bd_yPD7D.js";import{S as K,I as g,E as W,e as q}from"./ThemeContext-DRe09WSE.js";import{n as $}from"./navigation-BUwul1Ze.js";import{Y as O}from"./YesNoButton-BsHbI51V.js";import{P as R}from"./ColumnRenderers-CTwRHGdM.js";import{S as J}from"./Instance-ZaRjKoLj.js";import{E as v}from"./GenericErrorPage-C2ho8aty.js";import Q from"./NotFound-o4Sp_RYV.js";import{P as j}from"./PermissionDenied-Di_W_uvf.js";function w({pk:e,type:i}){const r=F(),{data:t}=A({queryKey:["badge",i,e],queryFn:async()=>{let c="";switch(i){case"owner":c=_.owner_list;break;case"user":c=_.user_list;break;case"group":c=_.group_list;break;default:return{}}const l=V(c,e);return r.get(l).then(m=>{switch(m.status){case 200:return m.data;default:return{}}}).catch(()=>({}))}}),n=M();if(!t||t.isLoading||t.isFetching)return a.jsx(B,{height:12,radius:"md"});function s(){return!t||!t.pk?"":i==="user"&&n.isSet("DISPLAY_FULL_NAMES")?t.first_name||t.last_name?`${t.first_name} ${t.last_name}`:t.username:i==="user"?t.username:t.name}return a.jsxs(h,{wrap:"nowrap",gap:"sm",justify:"right",children:[a.jsx(z,{color:"dark",variant:"filled",style:{display:"flex",alignItems:"center"},children:(t==null?void 0:t.name)??s()}),a.jsx(g,{icon:i==="user"?i:t.label})]})}function H(e){var i;return a.jsx(u,{size:"sm",children:G((i=e.field_value)==null?void 0:i.toString())})}function X(e){var t,n,s;const i=e==null?void 0:e.field_value;let r=null;return(t=e.field_data)!=null&&t.badge?a.jsx(w,{pk:i,type:e.field_data.badge}):((n=e==null?void 0:e.field_data)!=null&&n.value_formatter?r=e.field_data.value_formatter():i==null?r=a.jsx(u,{size:"sm",children:"'---'"}):r=a.jsx(u,{size:"sm",children:i.toString()}),a.jsxs(h,{wrap:"nowrap",gap:"xs",justify:"space-apart",children:[a.jsxs(h,{wrap:"nowrap",gap:"xs",justify:"left",children:[r,e.field_data.unit&&a.jsx(u,{size:"xs",children:e.unit})]}),e.field_data.user&&a.jsx(w,{pk:(s=e.field_data)==null?void 0:s.user,type:"user"})]}))}function Z(e){return a.jsx(O,{value:e.field_value})}function p(e){var m,y;const i=F(),r=q(),{data:t}=A({queryKey:["detail",e.field_data.model,e.field_value],queryFn:async()=>{var b;if(!((b=e.field_data)!=null&&b.model))return{};const d=N(e.field_data.model);if(!(d!=null&&d.api_endpoint))return{};const I=V(d.api_endpoint,e.field_value);return i.get(I,{params:e.field_data.model_filters??void 0}).then(S=>{switch(S.status){case 200:return S.data;default:return{}}}).catch(()=>({}))}}),n=x.useMemo(()=>{var d;return((d=e==null?void 0:e.field_data)==null?void 0:d.model)&&U(e.field_data.model,e.field_value)},[e.field_data.model,e.field_value]),s=x.useCallback(d=>{$(n,r,d)},[n]);if(!t||t.isLoading||t.isFetching)return a.jsx(B,{height:12,radius:"md"});if(e.field_data.external)return a.jsx(k,{href:`${e.field_value}`,target:"_blank",rel:"noreferrer noopener",children:a.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"3px"},children:[a.jsx(u,{children:e.field_value}),a.jsx(g,{icon:"external",iconProps:{size:15}})]})});let c=((m=e.field_data)==null?void 0:m.link)??!0,l;return e.field_data.model_formatter?l=e.field_data.model_formatter(t)??l:e.field_data.model_field?l=(t==null?void 0:t[e.field_data.model_field])??l:l=t==null?void 0:t.name,l===void 0&&(l=(t==null?void 0:t.name)??((y=e.field_data)==null?void 0:y.backup_value)??o._({id:"ATGKLv"}),c=!1),a.jsx(a.Fragment,{children:c?a.jsx(k,{href:"#",onClick:s,children:a.jsx(u,{children:l})}):a.jsx(u,{children:l})})}function ee(e){return e.field_data.total<=0?a.jsx(u,{size:"sm",children:e.field_data.progress}):a.jsx(R,{value:e.field_data.progress,maximum:e.field_data.total,progressLabel:!0})}function ae(e){return a.jsx(J,{type:e.field_data.model,status:e.field_value})}function te({value:e}){return a.jsx(W,{value:e})}function ie({item:e,field:i}){function r(s){switch(s){case"boolean":return Z;case"link":return p;case"progressbar":return ee;case"status":return ae;case"date":return H;case"text":case"string":default:return X}}const t=r(i.type),n=x.useMemo(()=>C(e,i.name),[e,i.name]);return a.jsxs(f.Tr,{style:{verticalAlign:"top"},children:[a.jsx(f.Td,{style:{width:"50",maxWidth:"50"},children:a.jsx(g,{icon:i.icon??i.name})}),a.jsx(f.Td,{style:{maxWidth:"65%",lineBreak:"auto"},children:a.jsx(u,{children:i.label})}),a.jsx(f.Td,{style:{lineBreak:"anywhere"},children:a.jsx(t,{field_data:i,field_value:n})}),a.jsx(f.Td,{style:{width:"50"},children:i.copy&&a.jsx(te,{value:n})})]})}function ye({item:e,fields:i,title:r}){return a.jsx(T,{p:"xs",withBorder:!0,radius:"xs",children:a.jsxs(L,{gap:"xs",children:[r&&a.jsx(K,{size:"lg",children:r}),a.jsx(f,{striped:!0,verticalSpacing:5,horizontalSpacing:"sm",children:a.jsx(f.Tbody,{children:i.filter(t=>!t.hidden).map((t,n)=>a.jsx(ie,{field:t,item:e},n))})})]})})}function be(e){const{ref:i,width:r}=D(),t=x.useMemo(()=>r>700?2:1,[r]);return a.jsx(T,{p:"xs",children:a.jsx(E,{cols:t,spacing:"xs",verticalSpacing:"xs",ref:i,children:e.children})})}function re(){return a.jsx(v,{title:o._({id:"vYV5VB"}),message:o._({id:"5a3xiK"})})}function ne({status:e}){switch(e){case 401:return a.jsx(re,{});case 403:return a.jsx(j,{});case 404:return a.jsx(Q,{})}return a.jsx(v,{title:o._({id:"AOPUbq"}),message:o._({id:"yuzYd9"}),status:e})}function se({status:e}){return a.jsx(v,{title:o._({id:"iSWuCp"}),message:o._({id:"vB3crB"}),status:e})}function Se({status:e,loading:i,children:r,requiredRole:t,requiredPermission:n}){const s=Y();return i||!s.isLoggedIn()?a.jsx(P,{}):e>=500?a.jsx(se,{status:e}):e>=400?a.jsx(ne,{status:e}):t&&!s.hasViewRole(t)?a.jsx(j,{}):n&&!s.hasViewPermission(n)?a.jsx(j,{}):a.jsx(a.Fragment,{children:r})}export{ye as D,be as I,Se as a};
