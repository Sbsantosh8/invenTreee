import{ea as A,bA as E,r as p,j as a,G as x,bE as z,bz as D,cj as N,eb as F,A as I,cp as K,bk as L,S as $,bB as B,bF as G,ec as R}from"./vendor-9x6k4T-r.js";import{u as T}from"./DesktopAppView-D7dqNL6j.js";import{n as U}from"./navigation-BUwul1Ze.js";import{f as q,e as M}from"./index-Bd_yPD7D.js";import{A as O}from"./ApiIcon-BBFuOj6_.js";import{e as Q,S as H}from"./ThemeContext-DRe09WSE.js";function Z({title:b,opened:c,onClose:g,selectedId:h,modelType:o,endpoint:w}){const k=T(),u=Q(),d=A(),r=E({enabled:c,queryKey:[o,c],queryFn:async()=>k.get(M(w),{data:{ordering:"level"}}).then(e=>e.data??[]).catch(e=>(console.error(`Error fetching ${o} tree`),[]))}),v=p.useCallback((e,s)=>{const i=q(o,e.value);s!=null&&s.shiftKey||s!=null&&s.ctrlKey?U(i,u,s):(g(),u(i))},[o,u]),C=p.useMemo(()=>{var i,f;const e={},s=[];if(!((i=r==null?void 0:r.data)!=null&&i.length))return[];for(let t=0;t<r.data.length;t++){const n={...r.data[t],children:[],label:a.jsxs(x,{gap:"xs",children:[a.jsx(O,{name:r.data[t].icon}),r.data[t].name]}),value:r.data[t].pk.toString(),selected:r.data[t].pk===h},j=n.pk,m=n.parent;if(m?(f=e[m])==null||f.children.push(n):s.push(n),e[j]=n,j===h){let l=e[n.parent];for(;l;)l.expanded=!0,l=e[l.parent]}}return s},[h,r.data]),S=p.useCallback(e=>a.jsxs(x,{justify:"left",wrap:"nowrap",onClick:()=>{e.hasChildren&&d.toggleExpanded(e.node.value)},children:[a.jsx(z,{w:5*e.level}),a.jsx(D,{size:"sm",variant:"transparent","aria-label":`nav-tree-toggle-${e.node.value}}`,children:e.hasChildren?e.expanded?a.jsx(N,{}):a.jsx(F,{}):null}),a.jsx(I,{onClick:s=>v(e.node,s),"aria-label":`nav-tree-item-${e.node.value}`,children:e.node.label})]},e.node.value),[d]);return a.jsx(K,{opened:c,size:"md",position:"left",onClose:g,withCloseButton:!0,styles:{header:{width:"100%"},title:{width:"100%"}},title:a.jsxs(x,{justify:"left",p:"ms",gap:"md",wrap:"nowrap",children:[a.jsx(L,{}),a.jsx(H,{size:"lg",children:b})]}),children:a.jsxs($,{gap:"xs",children:[a.jsx(B,{}),a.jsx(G,{visible:r.isFetching||r.isLoading}),a.jsx(R,{data:C,tree:d,renderNode:S})]})})}export{Z as N};
