import{cg as R,j as c,J as U,G as _,S as E,m as f,r as i,bE as F,v as k,ac as G,dy as z,i as h,n as m,R as V,eJ as L}from"./vendor-9x6k4T-r.js";import{r as $,a as q}from"./ThemeContext-DRe09WSE.js";import{u as A}from"./DesktopAppView-D7dqNL6j.js";import{a as B}from"./UseForm-C7xHtQGh.js";import{v as M,n as C,l as I,e as J,E as D,F as K}from"./index-Bd_yPD7D.js";function N({setting:e,onEdit:o,onToggle:l}){const u=i.useMemo(()=>{var r;let s=e.value;if(e!=null&&e.choices&&((r=e==null?void 0:e.choices)==null?void 0:r.length)>0){const n=e.choices.find(j=>j.value==e.value);s=(n==null?void 0:n.display_name)||e.value}return e!=null&&e.units&&(s=`${s} ${e.units}`),s},[e]);switch((e==null?void 0:e.type)||"string"){case"boolean":return c.jsx(z,{size:"sm",radius:"lg",checked:e.value.toLowerCase()=="true",onChange:s=>l(e,s.currentTarget.checked),style:{paddingRight:"20px"}});default:return u?c.jsxs(_,{gap:"xs",justify:"right",children:[c.jsx(F,{}),c.jsx(k,{variant:"subtle",onClick:()=>o(e),children:u})]}):c.jsx(k,{variant:"subtle",onClick:()=>o(e),children:c.jsx(G,{})})}}function H({setting:e,shaded:o,onEdit:l,onToggle:u}){const{colorScheme:s}=R(),r={paddingLeft:"8px"};return o&&(r.backgroundColor=s==="light"?M.colors.gray[1]:M.colors.gray[9]),c.jsx(U,{style:r,children:c.jsxs(_,{justify:"space-between",p:"3",children:[c.jsxs(E,{gap:"2",p:"4px",children:[c.jsxs(f,{children:[e.name,e.required?" *":""]}),c.jsx(f,{size:"xs",children:e.description})]}),c.jsx($,{label:`setting-value-${e.key}`,children:c.jsx(N,{setting:e,onEdit:l,onToggle:u})})]})})}function x({settingsState:e,keys:o,onChange:l}){var y,v,S;i.useEffect(()=>{e.fetchSettings()},[]);const u=A(),s=i.useMemo(()=>{var a;return((a=e==null?void 0:e.settings)==null?void 0:a.map(d=>d.key))??[]},[e==null?void 0:e.settings]),[r,n]=i.useState(void 0),j=i.useMemo(()=>{var a;return(a=r==null?void 0:r.choices)!=null&&a.length?"choice":(r==null?void 0:r.type)!=null?r.type:"string"},[r]),t=B({url:e.endpoint,pk:r==null?void 0:r.key,pathParams:e.pathParams,title:h._({id:"mjN1LS"}),fields:{value:{field_type:j,required:(r==null?void 0:r.required)??!1,label:r==null?void 0:r.name,description:r==null?void 0:r.description,api_url:(r==null?void 0:r.api_url)??"",model:((y=r==null?void 0:r.model_name)==null?void 0:y.split(".")[1])??null,choices:(r==null?void 0:r.choices)??void 0}},successMessage:h._({id:"n/n6vh",values:{0:r==null?void 0:r.key}}),onFormSuccess:()=>{e.fetchSettings(),l==null||l()}}),P=i.useCallback(a=>{n(a),t.open()},[t]),T=i.useCallback((a,d)=>{u.patch(J(e.endpoint,a.key,e.pathParams),{value:d}).then(()=>{m.hide("setting"),m.show({title:h._({id:"C3htzi"}),message:h._({id:"n/n6vh",values:{0:a.key}}),color:"green",id:"setting"}),l==null||l()}).catch(p=>{m.hide("setting"),m.show({title:h._({id:"CsUgn+"}),message:p.message,color:"red",id:"setting"})}).finally(()=>{e.fetchSettings()})},[e]);return c.jsxs(c.Fragment,{children:[t.modal,c.jsxs(E,{gap:"xs",children:[(v=o||s)==null?void 0:v.map((a,d)=>{var b;const p=(b=e==null?void 0:e.settings)==null?void 0:b.find(w=>w.key===a);return e!=null&&e.settings&&!p&&console.error(`Setting ${a} not found`),c.jsx(V.Fragment,{children:p?c.jsx(H,{setting:p,shaded:d%2===0,onEdit:P,onToggle:T}):c.jsxs(f,{size:"sm",style:{fontStyle:"italic"},c:"red",children:["Setting ",a," not found"]})},a)}),((S=o||s)==null?void 0:S.length)===0&&c.jsx(f,{style:{fontStyle:"italic"},children:c.jsx(q,{id:"3CUVvD"})})]})]})}function Z({keys:e}){const o=C();return c.jsx(x,{settingsState:o,keys:e})}function g({keys:e}){const o=I();return c.jsx(x,{settingsState:o,keys:e})}function ee({pluginKey:e}){const o=i.useRef(D({plugin:e})).current,l=L(o);return c.jsx(x,{settingsState:l})}function re({machinePk:e,configType:o,onChange:l}){const u=i.useRef(K({machine:e,configType:o})).current,s=L(u);return c.jsx(x,{settingsState:s,onChange:l})}export{g as G,re as M,ee as P,Z as U};
